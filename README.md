# Richman - Cè¯­è¨€TDDå¼€å‘æŒ‡å—

## ğŸ“– é¡¹ç›®ç®€ä»‹

Richmanæ˜¯ä¸€ä¸ªä½¿ç”¨æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰æ–¹æ³•æ„å»ºçš„Cè¯­è¨€é¡¹ç›®ã€‚æœ¬é¡¹ç›®å±•ç¤ºäº†å¦‚ä½•åœ¨Cè¯­è¨€ç¯å¢ƒä¸‹å»ºç«‹å®Œæ•´çš„TDDå·¥ä½œæµç¨‹ï¼ŒåŒ…æ‹¬è‡ªåˆ¶æµ‹è¯•æ¡†æ¶ã€è‡ªåŠ¨åŒ–æ„å»ºå’Œæµ‹è¯•ç®¡ç†ã€‚

**è½¯ä»¶å·¥ç¨‹2ç»„** - å±•ç¤ºCè¯­è¨€TDDå¼€å‘æœ€ä½³å®è·µ

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
Richman/
â”œâ”€â”€ include/              # å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ calculator.h      # è®¡ç®—å™¨å‡½æ•°å£°æ˜
â”‚   â”œâ”€â”€ mathutils.h       # æ•°å­¦å·¥å…·å‡½æ•°å£°æ˜
â”‚   â”œâ”€â”€ hello.h           # é—®å€™åŠŸèƒ½å‡½æ•°å£°æ˜
â”‚   â””â”€â”€ test_framework.h  # è‡ªåˆ¶æµ‹è¯•æ¡†æ¶
â”œâ”€â”€ src/                  # æºä»£ç å®ç°
â”‚   â”œâ”€â”€ calculator.c      # è®¡ç®—å™¨åŠŸèƒ½å®ç°
â”‚   â”œâ”€â”€ mathutils.c       # æ•°å­¦å·¥å…·å®ç°
â”‚   â”œâ”€â”€ hello.c           # é—®å€™åŠŸèƒ½å®ç°
â”‚   â””â”€â”€ test_framework.c  # æµ‹è¯•æ¡†æ¶å®ç°
â”œâ”€â”€ tests/                # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ test_calculator.c # è®¡ç®—å™¨æµ‹è¯•
â”‚   â”œâ”€â”€ test_mathutils.c  # æ•°å­¦å·¥å…·æµ‹è¯•
â”‚   â”œâ”€â”€ test_hello.c      # é—®å€™åŠŸèƒ½æµ‹è¯•
â”‚   â””â”€â”€ test_runner.c     # æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ obj/                  # ç¼–è¯‘å¯¹è±¡æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ bin/                  # å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ Makefile              # æ„å»ºé…ç½®
â”œâ”€â”€ test_batch.txt        # æ‰¹é‡æµ‹è¯•é…ç½®
â””â”€â”€ README.md             # æœ¬æ–‡ä»¶
```

## âš¡ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- **ç¼–è¯‘å™¨**: gcc (æ”¯æŒC99)
- **æ„å»ºå·¥å…·**: make
- **ç‰ˆæœ¬æ§åˆ¶**: git
- **æ“ä½œç³»ç»Ÿ**: Linux/Unix (WSL2æ”¯æŒ)
- **æ ‡å‡†åº“**: åªéœ€è¦Cæ ‡å‡†åº“ï¼Œæ— å¤–éƒ¨ä¾èµ–

### å…‹éš†å’Œæ„å»º

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/ottoiflu/Richman.git
cd Richman

# åˆ‡æ¢åˆ°å¼€å‘åˆ†æ”¯
git checkout zhn

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
make test

# æ¸…ç†æ„å»ºæ–‡ä»¶
make clean
```

## ğŸ”„ TDDå¼€å‘æµç¨‹

### TDDä¸‰æ­¥æ³•åˆ™

1. **ğŸ”´ Red**: å…ˆå†™å¤±è´¥çš„æµ‹è¯•
2. **ğŸŸ¢ Green**: å†™æœ€å°‘ä»£ç è®©æµ‹è¯•é€šè¿‡  
3. **ğŸ”µ Refactor**: é‡æ„æ”¹è¿›ä»£ç è´¨é‡

### å®é™…å¼€å‘ç¤ºä¾‹

#### æ­¥éª¤1: åˆ›å»ºæµ‹è¯•æ–‡ä»¶ (Red)

```c
// tests/test_newfeature.c
#include "test_framework.h"
#include "newfeature.h"

TEST(NewFeatureTest, BasicFunction) {
    int result = newfeature_calculate(5);
    EXPECT_EQ(25, result);
}
```

#### æ­¥éª¤2: åˆ›å»ºå¤´æ–‡ä»¶

```c
// include/newfeature.h
#ifndef NEWFEATURE_H
#define NEWFEATURE_H

#ifdef __cplusplus
extern "C" {
#endif

// æ–°åŠŸèƒ½å‡½æ•°å£°æ˜
int newfeature_calculate(int input);

#ifdef __cplusplus
}
#endif

#endif /* NEWFEATURE_H */
```

#### æ­¥éª¤3: å®ç°åŠŸèƒ½ (Green)

```c
// src/newfeature.c
#include "newfeature.h"

int newfeature_calculate(int input) {
    return input * input;  // æœ€ç®€å®ç°
}
```

#### æ­¥éª¤4: è¿è¡Œæµ‹è¯•

```bash
make test
```

## ğŸ§ª æµ‹è¯•ç®¡ç†

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
make test
```

### è‡ªå®šä¹‰æµ‹è¯•è¿è¡Œ

ç”±äºæˆ‘ä»¬ä½¿ç”¨è‡ªåˆ¶çš„æµ‹è¯•æ¡†æ¶ï¼Œæµ‹è¯•è¿è¡Œæ›´åŠ ç®€å•ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰
make test

# ç›´æ¥è¿è¡Œæµ‹è¯•å¯æ‰§è¡Œæ–‡ä»¶
./bin/run_tests
```

æ³¨æ„ï¼šæˆ‘ä»¬çš„è½»é‡çº§æµ‹è¯•æ¡†æ¶ä¼šè‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œè¾“å‡ºæ¸…æ™°çš„æµ‹è¯•ç»“æœã€‚

### æ‰¹é‡æµ‹è¯•é…ç½®

æˆ‘ä»¬çš„Cè¯­è¨€ç‰ˆæœ¬ä¿æŒäº†æ‰¹é‡æµ‹è¯•åŠŸèƒ½ï¼š

```bash
# è¿è¡Œæ‰¹é‡æµ‹è¯•
make run-batch
```

æ³¨æ„ï¼šæ‰¹é‡æµ‹è¯•åœ¨Cè¯­è¨€ç‰ˆæœ¬ä¸­è¿è¡Œæ‰€æœ‰å·²ç¼–è¯‘çš„æµ‹è¯•ï¼Œé…ç½®æ–‡ä»¶ç”¨äºè®°å½•æµ‹è¯•è®¡åˆ’ã€‚

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. **åˆ›å»ºæµ‹è¯•æ–‡ä»¶**: `tests/test_yourfeature.c`
2. **ç¼–å†™å¤±è´¥æµ‹è¯•**: å®šä¹‰æœŸæœ›çš„æ¥å£å’Œè¡Œä¸º
3. **åˆ›å»ºå¤´æ–‡ä»¶**: `include/yourfeature.h`
4. **å®ç°åŠŸèƒ½**: `src/yourfeature.c`
5. **æ›´æ–°æµ‹è¯•è¿è¡Œå™¨**: åœ¨ `tests/test_runner.c` ä¸­æ·»åŠ æ–°æµ‹è¯•
6. **è¿è¡Œæµ‹è¯•**: `make test`
7. **é‡æ„ä¼˜åŒ–**: æ”¹è¿›ä»£ç è´¨é‡

### æµ‹è¯•ç¼–å†™è§„èŒƒ

#### æµ‹è¯•å‘½å

```c
TEST(ModuleNameTest, FunctionName_Condition_ExpectedBehavior) {
    // æµ‹è¯•å®ç°
}
```

#### æµ‹è¯•ç»“æ„ (AAAæ¨¡å¼)

```c
TEST(CalculatorTest, Add_TwoPositiveNumbers_ReturnsSum) {
    // Arrange (å‡†å¤‡)
    int a = 2, b = 3;
    
    // Act (æ‰§è¡Œ)
    int result = calculator_add(a, b);
    
    // Assert (æ–­è¨€)
    EXPECT_EQ(5, result);
}
```

#### å­—ç¬¦ä¸²æµ‹è¯•

```c
TEST(HelloTest, SayHello_DefaultGreeting_ReturnsCorrectString) {
    // Arrange
    char buffer[100];
    
    // Act
    hello_say_hello(buffer, sizeof(buffer));
    
    // Assert
    EXPECT_STREQ("Hello, World!", buffer);
}
```

#### æ·»åŠ æ–°æµ‹è¯•åˆ°è¿è¡Œå™¨

åœ¨ `tests/test_runner.c` ä¸­æ·»åŠ ï¼š

```c
// å£°æ˜æ–°æµ‹è¯•å‡½æ•°
extern void run_YourModuleTest_YourFunction(void);

// åœ¨mainå‡½æ•°ä¸­æ·»åŠ 
int main(void) {
    // ... ç°æœ‰ä»£ç  ...
    
    // è¿è¡Œä½ çš„æ–°æµ‹è¯•
    printf("[----------] 1 test from YourModuleTest\n");
    RUN_TEST(YourModuleTest, YourFunction);
    printf("[----------] 1 test from YourModuleTest (0 ms total)\n\n");
    
    // ... ç°æœ‰ä»£ç  ...
}
```

## ğŸ“Š æµ‹è¯•ç­–ç•¥

### æµ‹è¯•ç±»å‹

1. **å•å…ƒæµ‹è¯•**: æµ‹è¯•å•ä¸ªç±»æˆ–å‡½æ•°
2. **é›†æˆæµ‹è¯•**: æµ‹è¯•æ¨¡å—é—´äº¤äº’
3. **ç³»ç»Ÿæµ‹è¯•**: æµ‹è¯•å®Œæ•´åŠŸèƒ½æµç¨‹

### æµ‹è¯•è¦†ç›–

- **åŠŸèƒ½è¦†ç›–**: æµ‹è¯•æ‰€æœ‰å…¬å…±æ¥å£
- **è¾¹ç•Œæµ‹è¯•**: æµ‹è¯•è¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸æƒ…å†µ
- **å›å½’æµ‹è¯•**: ç¡®ä¿ä¿®æ”¹ä¸ç ´åç°æœ‰åŠŸèƒ½

### æµ‹è¯•ç»„ç»‡

```c
// æŒ‰åŠŸèƒ½åˆ†ç»„ - å°†ç›¸å…³æµ‹è¯•æ”¾åœ¨åŒä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ä¸­
// tests/test_game_calculation.c
TEST(GameCalculationTest, HealthCalculation) { ... }
TEST(GameCalculationTest, ExperienceCalculation) { ... }

// æŒ‰åœºæ™¯åˆ†ç»„ - åœ¨åŒä¸€ä¸ªTESTå¥—ä»¶ä¸­æµ‹è¯•ä¸åŒæƒ…å†µ
TEST(CalculatorTest, Add_PositiveNumbers) { ... }
TEST(CalculatorTest, Add_NegativeNumbers) { ... }
TEST(CalculatorTest, Add_ZeroValues) { ... }
```

## ğŸš€ æ„å»ºå’Œéƒ¨ç½²

### æœ¬åœ°å¼€å‘

```bash
# å¼€å‘æ¨¡å¼ï¼šæŒç»­æµ‹è¯•
make test

# æ¸…ç†é‡å»º
make clean && make test

# æ„å»ºä¸»ç¨‹åºï¼ˆå¦‚æœæœ‰mainå‡½æ•°ï¼‰
make all
```

### CI/CDé›†æˆ

é¡¹ç›®æ”¯æŒæŒç»­é›†æˆï¼Œæ¯æ¬¡æäº¤éƒ½ä¼šè‡ªåŠ¨è¿è¡Œæµ‹è¯•ï¼š

```bash
# æäº¤å‰ç¡®ä¿æµ‹è¯•é€šè¿‡
make test
git add .
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"
git push origin your-branch
```

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: ç¼–è¯‘é”™è¯¯ "missing separator"

**é—®é¢˜**: Makefileæ ¼å¼é”™è¯¯
**è§£å†³**: ç¡®ä¿å‘½ä»¤è¡Œä½¿ç”¨TABå­—ç¬¦ç¼©è¿›ï¼Œä¸æ˜¯ç©ºæ ¼

### Q2: æµ‹è¯•å¤±è´¥ "undefined reference to main"

**é—®é¢˜**: ç¼ºå°‘mainå‡½æ•°
**è§£å†³**: ç¡®ä¿ `tests/test_runner.c` ä¸­åŒ…å«mainå‡½æ•°ï¼Œå¹¶ä¸”æ­£ç¡®é“¾æ¥äº†æ‰€æœ‰æµ‹è¯•æ–‡ä»¶ã€‚

### Q3: æ‰¾ä¸åˆ°å¤´æ–‡ä»¶

**é—®é¢˜**: åŒ…å«è·¯å¾„é”™è¯¯
**è§£å†³**: ç¡®ä¿å¤´æ–‡ä»¶åœ¨ `include/` ç›®å½•ä¸‹ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„åŒ…å«

### Q4: é“¾æ¥é”™è¯¯

**é—®é¢˜**: æºæ–‡ä»¶æœªç¼–è¯‘æˆ–é“¾æ¥
**è§£å†³**: ç¡®ä¿æºæ–‡ä»¶åœ¨ `src/` ç›®å½•ä¸‹ï¼ŒMakefileä¼šè‡ªåŠ¨å‘ç°

### Q5: æ–°æµ‹è¯•æ²¡æœ‰è¿è¡Œ

**é—®é¢˜**: æ·»åŠ äº†æ–°æµ‹è¯•ä½†æ²¡æœ‰æ‰§è¡Œ
**è§£å†³**: åœ¨ `tests/test_runner.c` ä¸­æ·»åŠ æ–°æµ‹è¯•çš„å£°æ˜å’Œè°ƒç”¨

## ğŸ“š å­¦ä¹ èµ„æº

### Cè¯­è¨€TDDèµ„æº

- [Cè¯­è¨€å•å…ƒæµ‹è¯•æœ€ä½³å®è·µ](https://github.com/ThrowTheSwitch/Unity)
- [TDD by Example (Kent Beck)](https://www.amazon.com/Test-Driven-Development-Kent-Beck/dp/0321146530)

### TDDæœ€ä½³å®è·µ

- **Red-Green-Refactor**: ä¸¥æ ¼éµå¾ªTDDå¾ªç¯
- **å°æ­¥å¿«è·‘**: æ¯æ¬¡åªæ·»åŠ æœ€å°å¯æµ‹è¯•åŠŸèƒ½
- **æµ‹è¯•å…ˆè¡Œ**: æ°¸è¿œå…ˆå†™æµ‹è¯•å†å†™å®ç°
- **é‡æ„ä¹ æƒ¯**: å®šæœŸé‡æ„æé«˜ä»£ç è´¨é‡

### ç¤ºä¾‹ä»£ç 

æŸ¥çœ‹ `tests/` ç›®å½•ä¸‹çš„æµ‹è¯•æ–‡ä»¶ï¼Œäº†è§£ä¸åŒæµ‹è¯•æ¨¡å¼ï¼š

- `test_calculator.c`: åŸºç¡€å•å…ƒæµ‹è¯•
- `test_mathutils.c`: ç®—æ³•æµ‹è¯•
- `test_hello.c`: å­—ç¬¦ä¸²å¤„ç†æµ‹è¯•
- `test_runner.c`: æµ‹è¯•è¿è¡Œå™¨ç¤ºä¾‹

### Cè¯­è¨€ç‰¹æœ‰æ³¨æ„äº‹é¡¹

- **å†…å­˜ç®¡ç†**: æ‰‹åŠ¨ç®¡ç†å†…å­˜åˆ†é…å’Œé‡Šæ”¾
- **å­—ç¬¦ä¸²å¤„ç†**: ä½¿ç”¨å­—ç¬¦æ•°ç»„å’Œæ ‡å‡†å­—ç¬¦ä¸²å‡½æ•°
- **å‡½æ•°å‘½å**: ä½¿ç”¨æ¨¡å—å‰ç¼€é¿å…å‘½åå†²çª
- **å¤´æ–‡ä»¶ä¿æŠ¤**: ä½¿ç”¨ `#ifdef __cplusplus` æ”¯æŒC++å…¼å®¹

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. **Forkä»“åº“**: åˆ›å»ºè‡ªå·±çš„åˆ†æ”¯
2. **éµå¾ªTDD**: å…ˆå†™æµ‹è¯•å†å†™å®ç°
3. **ä»£ç è§„èŒƒ**: éµå¾ªCè¯­è¨€ç¼–ç æ ‡å‡†
4. **æµ‹è¯•è¦†ç›–**: ç¡®ä¿æ–°åŠŸèƒ½æœ‰å¯¹åº”æµ‹è¯•
5. **æäº¤è§„èŒƒ**: ä½¿ç”¨æ¸…æ™°çš„æäº¤ä¿¡æ¯
6. **Pull Request**: æäº¤å‰ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ‘¥ å›¢é˜Ÿæˆå‘˜

**è½¯ä»¶å·¥ç¨‹2ç»„**
- @Cliper314 (zc)
- @ottoiflu (Otto_Hust)

---

**Happy Coding with TDD! ğŸ‰**

æœ‰é—®é¢˜è¯·æäº¤Issueæˆ–è”ç³»å›¢é˜Ÿæˆå‘˜ã€‚